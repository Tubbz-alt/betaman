= form_for @user do |f|
  - if @user.errors.any?
    #error_explanation
      %h2= "#{pluralize(@user.errors.count, "error")} prohibited this user from being saved:"
      %ul
        - @user.errors.full_messages.each do |msg|
          %li= msg
  %table
    %tr
      %td.right.bold.top
        Last name
      %td
        = f.text_field :last_name
    %tr
      %td.right.bold.top
        First name
      %td
        = f.text_field :first_name
    %tr
      .field
        %td.right.bold.top
          Email
        %td= f.text_field :email
    %tr
      .field
        %td.right.bold.top
          Login name
        %td= f.text_field 'login_name'
    %tr
      %td.right.bold.top
        User ID
      %td= @user.id
    %tr
      %td.right.top.bold Roles
      %td
        %table
          - @user.roles.each do |role|
            %tr
              %td=role.name

    %tr
      %td.right.top.bold Lists
      %td
        %table
          - @user.lists.each do |list|
            %tr
              %td=link_to(list.name, list_path(list) )

    - if @current_user.admin?
      %tr 
        %td.right.top.bold Betas
        %td
          %table
            - @user.betas.each do |beta|
              %tr
                %td
                  =link_to(beta.name,beta_path(beta) )
                  =link_to(user_remove_beta_path(@user, beta_id: beta) ) do
                    %i.icon-trash
            - if !@available_betas.empty?
              %tr
                %td 
                  .btn-group
                    %a{:class => "btn btn-mini dropdown-toggle", "data-toggle" => "dropdown", :href => "#"}
                      Add available beta
                      %b.caret
                    %ul.dropdown-menu
                      - @available_betas.each do |beta|
                        %li= link_to beta.name, user_add_beta_path(@user, beta_id: beta)

            - if !@available_finished_betas.empty?
              %tr
                %td 
                  .btn-group
                    %a{:class => "btn btn-mini dropdown-toggle", "data-toggle" => "dropdown", :href => "#"}
                      Add finished beta 
                      %b.caret
                    %ul.dropdown-menu
                      - @available_finished_betas.each do |beta|
                        %li= link_to beta.name, user_add_beta_path(@user, beta_id: beta)

    - if @user.address
      = f.fields_for :address do |af|
        %tr
          %td.right.top.bold Street Address
          %td= af.text_field :address1
        %tr
          %td.right.top.bold Adress 2
          %td= af.text_field :address2
        %tr
          %td.right.top.bold Adress 3
          %td= af.text_field :address3
        %tr
          %td.right.top.bold City
          %td= af.text_field :city
        %tr
          %td.right.top.bold Zip/Postal code
          %td= af.text_field :zip
        %tr
          %td.right.top.bold Country
          %td= af.text_field :country
        %tr
          %td.right.top.bold State/Province
          %td= af.text_field :state
        %tr
          %td.right.top.bold Telephone
          %td= af.text_field :phone
    - else
      %tr
        %td Address
        %td
          = link_to('Add address', user_add_address_path(@user), class: 'btn btn-mini' ) 
  .actions
    = f.submit 'Save', class: 'btn btn-success'

